---
- include: bootstrap.yml
- include: secure-variables.yml

- name: Set up a fresh environment
  hosts: targets
  sudo: no

  vars_files:
    - vars/aws.yml

  pre_tasks:
    - name: Load secure variables from S3.
      include_vars: vars/secure.yml

  roles:
    - role: zsh
      tags: [ 'zsh' ]

    - role: git
      tags: [ 'git' ]

    - role: rvm
      tags: [ 'rvm' ]

    - role: node
      tags: [ 'node' ]

    - role: chef
      tags: [ 'chef' ]

    - role: password-store
      tags: [ 'password-store' ]

    - role: chromium
      tags: [ 'chromium' ]

    - role: sublime
      tags: [ 'sublime' ]

    - role: hipchat
      tags: [ 'hipchat' ]

- include: cleanup.yml
